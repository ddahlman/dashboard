"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}google.charts.load("current",{packages:["corechart","geochart"],mapsApiKey:"AIzaSyDMPDZMkd7YLnBpiKeBAq2HZYfjdWS8FA4"}),google.charts.setOnLoadCallback(function(){addFirstCharts()});var g={container2:document.getElementById("container-2"),toolbar:document.querySelector(".dashboard-toolbar"),pseudoCircle:document.querySelector(".pseudo-circle"),menu1:document.querySelector(".menu-1"),box:document.querySelector(".box"),removeBox:document.querySelector(".close"),wrap:document.getElementById("grid"),slotObjects:[],dataId:[],allCharts:[],chartPositions:[],slotsPerRow:8,allSlots:[],selected:null,originalIndex:null,originalClickCoords:null,lastTouched:null},slot=function(t){var e={num:t,aspectWidth:1920,aspectHeight:1080};return Object.assign({},createSlotDiv(e),createDivArray(e))},createSlotDiv=function(t){return{createDiv:function(e){var a=document.createElement("div");a.setAttribute("style","width: "+100/g.slotsPerRow+"%; padding-bottom: "+100/g.slotsPerRow*(t.aspectHeight/t.aspectWidth)+"%;"),a.setAttribute("class","dd-slot");var o={xPos:Math.floor(e/g.slotsPerRow)+1,yPos:e%g.slotsPerRow+1,status:"available"};return g.slotObjects.push(o),a.setAttribute("data-slot-x",g.slotObjects[e].xPos),a.setAttribute("data-slot-y",g.slotObjects[e].yPos),a.setAttribute("data-status",g.slotObjects[e].status),a.innerHTML='<p class="dd-slot-num dd-vc">'+(e+1)+"</p>",a}}},createDivArray=function(t){return{createArray:function(){return[].concat(_toConsumableArray(Array(t.num))).map(function(t,e){return slot().createDiv(e)})}}},slotBounds=function(t){var e={wrapBounds:g.wrap.getBoundingClientRect(),slotSize:document.getElementsByClassName("dd-slot")[0].getBoundingClientRect(),num:t};return Object.assign({},slotWidth(e),slotHeight(e),addToSlotObjects(e))},slotWidth=function(t){return{width:function(){switch(t.num){case 2:return 2*t.slotSize.width;case 3:return 3*t.slotSize.width;default:return t.slotSize.width}}}},slotHeight=function(t){return{height:function(){switch(t.num){case 2:return 2*t.slotSize.height;case 3:return 3*t.slotSize.height;default:return t.slotSize.height}}}},addToSlotObjects=function(t){return{add:function(){return[].concat(_toConsumableArray(document.getElementsByClassName("dd-slot"))).forEach(function(e,a){var o=e.getBoundingClientRect();Object.assign(g.slotObjects[a],{y:o.top-t.wrapBounds.top,x:o.left-t.wrapBounds.left,bottom:o.bottom-t.wrapBounds.bottom,right:o.right-t.wrapBounds.right,width:o.width,height:o.height})})}}},addSlotsToDOM=function(t){var e=t;return{go:function(){e.forEach(function(t,e){g.wrap.appendChild(t)}),slotBounds().add()}}},pieFunction=function(t,e){var a={obj:t,div:e};return{go:function(){a.obj.options.pieStartAngle=0;var t=new google.visualization.PieChart(a.div);google.visualization.events.addListener(t,"ready",function(){a.obj.options.pieStartAngle<10&&(a.obj.options.pieStartAngle++,setTimeout(function(){t.draw(a.obj.data,a.obj.options)},0))}),t.draw(a.obj.data,a.obj.options)}}},chart=function(t,e,a,o){var r={response:t,optionType:e,type:a,div:o};return{getChart:function(){var t={};switch(t.data=new google.visualization.DataTable(r.response.data),t.options=r.response.options[r.optionType],r.type){case"PieChart":t.draw=function(){return pieFunction(t,r.div).go()};break;default:t.draw=function(){return new google.visualization[r.type](r.div).draw(t.data,t.options)}}return t}}},chartDiv=function(t){var e={cssClass:t,width2:slotBounds(2).width(),width3:slotBounds(3).width(),height2:slotBounds(2).height(),height3:slotBounds(3).height()};return{createDiv:function(){var t=document.createElement("div");switch(e.cssClass){case"geo":t.setAttribute("style","width:"+e.width3+"px; height:"+e.height3+"px;");break;case"pie":t.setAttribute("style","width:"+e.width2+"px; height:"+e.height3+"px;");break;case"area":case"line":t.setAttribute("style","width:"+e.width2+"px; height:"+e.height2+"px;");break;case"bar":t.setAttribute("style","width:"+e.width3+"px; height:"+e.height3+"px;")}return t.classList.add(e.cssClass),t}}},chartSize=function(t){var e=t;return{getSize:function(){var t=e.style.width,a=e.style.height;return{elWidth:Math.round(t.substring(0,t.length-2)),elHeight:Number(a.substring(0,a.length-2))}}}},getGridPositions=function(t,e){var a=t,o=e;return{go:function(){var t=g.slotObjects[a],e=chartSize(o).getSize(),r=e.elWidth,s=e.elHeight,i=[Math.round(t.width),t.height],n=i[0],l=i[1],c=function(t,e){return document.querySelector('[data-slot-x="'+t+'"][data-slot-y="'+e+'"]')},d=[g.slotObjects[a+1],g.slotObjects[a+2],g.slotObjects[a+2+g.slotsPerRow],g.slotObjects[a+(g.slotsPerRow+1)],g.slotObjects[a+g.slotsPerRow],g.slotObjects[a+2*g.slotsPerRow],g.slotObjects[a+2*g.slotsPerRow+1],g.slotObjects[a+2*g.slotsPerRow+2]],u=d[0],h=d[1],p=d[2],v=d[3],b=d[4],f=d[5],y=d[6],m=d[7],w=[c(t.xPos,t.yPos),c(b.xPos,b.yPos),c(u.xPos,u.yPos),c(h.xPos,h.yPos),c(v.xPos,v.yPos),c(p.xPos,p.yPos),c(f.xPos,f.yPos),c(y.xPos,y.yPos),c(m.xPos,m.yPos)],x=w[0],C=w[1],P=w[2],S=w[3],A=w[4],O=w[5],j=w[6],I=w[7],B=w[8];return r===2*n&&s===2*l?([t,b,u,v,x.dataset,C.dataset,P.dataset,A.dataset].map(function(t){return t.status="occupied"}),{x:t.x,y:t.y,width:r,height:s}):r===2*n&&s===3*l?([t,b,u,v,f,y,x.dataset,C.dataset,P.dataset,A.dataset,j.dataset,I.dataset].map(function(t){return t.status="occupied"}),{x:t.x,y:t.y,width:r,height:s}):r===3*n&&s===3*l?([t,b,u,v,f,y,h,m,p,x.dataset,C.dataset,P.dataset,A.dataset,j.dataset,I.dataset,S.dataset,B.dataset,O.dataset].map(function(t){return t.status="occupied"}),{x:t.x,y:t.y,width:r,height:s}):void 0}}},isNotOverlapping=function(t,e){var a=e,o=slotBounds(2).width(),r=slotBounds(3).width(),s=g.slotObjects[t].yPos,i=g.slotObjects[t].status,n=g.slotObjects[t+1].status,l=g.slotObjects[t+2].status,c=g.slotObjects[t+g.slotsPerRow].status,d=g.slotObjects[t+2*g.slotsPerRow].status;return{check:function(){switch(a){case o:return s<8&&"available"===i&&"available"===n&&"available"===c&&"available"===d;case r:return s<7&&"available"===i&&"available"===n&&"available"===l}}}},placeCharts=function(t){var e=t.div,a=t.chart,o=t.indx,r=t.increment,s=t.width,i=t.height;return{go:function(){var t=getGridPositions(o,e).go();e.classList.add("dd-item","dd-transition"),e.style.transform="translate3d("+t.x+"px, "+t.y+"px,0px)",e.setAttribute("data-id",r),g.wrap.appendChild(e),a.draw(),console.log(e.childNodes),e.addEventListener("mousedown",chartMouseDown),e.addEventListener("mouseup",chartMouseUp),g.chartPositions[r-1]={width:s,height:i,x:t.x,y:t.y},g.dataId.push(e.dataset.id),g.allCharts.push(e)}}},addChartToDOM=function(t){var e={chartType:t,wrap:g.wrap,div:chartDiv(t.id).createDiv(),len:g.dataId.length,selectedReportId:document.querySelector("[data-selected]")};return{go:function(){var t=void 0,a=void 0;e.selectedReportId&&(t=e.selectedReportId.id,e.selectedReportId.removeAttribute("data-selected")),e.chartType&&(a=e.chartType.id),t&&fetch("api/?/reports").then(function(t){return t.json()}).then(function(o){var r=void 0;switch(a){case"area":r=chart(o.reports[t],"regular","AreaChart",e.div).getChart();break;case"geo":r=chart(o.reports[t],"regular","GeoChart",e.div).getChart();break;case"pie":r=chart(o.reports[t],"pie","PieChart",e.div).getChart();break;case"line":r=chart(o.reports[t],"regular","LineChart",e.div).getChart();break;case"bar":r=chart(o.reports[t],"regular","BarChart",e.div).getChart()}var s=chartSize(e.div).getSize(),i=s.elWidth,n=s.elHeight,l=availableIndex(i).get(),c={div:e.div,chart:r,indx:l,increment:e.len+1,width:i,height:n};placeCharts(c).go()})}}},availableIndex=function(t){var e=t;return{get:function(){return g.allSlots.findIndex(function(t,a){return isNotOverlapping(a,e).check()?a:""})}}},arrangeItems=function(){var t={dataId:g.dataId,chartPos:g.chartPositions};return{go:function(){return t.dataId.forEach(function(e,a){var o=t.chartPos[a];document.querySelector('[data-id="'+e+'"]').style.transform="translate3d("+o.x+"px, "+o.y+"px, 0px)"})}}},arrangeItemsMouseUp=function(){var t={increment:0,allSlots:g.allSlots,slotObjects:g.slotObjects,chartPos:g.chartPositions,dataId:g.dataId};return{go:function(){return t.allSlots.map(function(e,a,o){if("occupied"!==t.slotObjects[a].status&&(t.increment++,void 0!==t.dataId[t.increment-1])){var r=t.dataId[t.increment-1],s=document.querySelector('[data-id="'+r+'"]'),i=chartSize(s).getSize(),n=i.elWidth,l=(i.elHeight,void 0);if(isNotOverlapping(a,n).check())l=getGridPositions(a,s).go(),s.style.transform="translate3d("+l.x+"px, "+l.y+"px,0px)",t.chartPos[t.increment-1]={width:l.width,height:l.height,x:l.x,y:l.y};else{var c=availableIndex(n).get();l=getGridPositions(c,s).go(),s.style.transform="translate3d("+l.x+"px, "+l.y+"px,0px)",t.chartPos[t.increment-1]={width:l.width,height:l.height,x:l.x,y:l.y}}}})}}},getChartIdByCoords=function(t){var e=g.chartPositions;return{go:function(){for(var a in e){var o=e[a];if(o.x<=t.x&&t.x<=o.x+o.width&&o.y<=t.y&&t.y<=o.y+o.height)return a}}}},getSlotIdByCoords=function(t){var e=g.slotObjects;return{go:function(){for(var a in e){var o=e[a];if(o.x<=t.x&&t.x<=o.x+o.width&&o.y<=t.y&&t.y<=o.y+o.height)return a}}}},getIndexOfChartId=function(t){var e=g.dataId.length;return{go:function(){for(var a=0;a<e;a++)if(g.dataId[a]===t)return a}}},removeMenu=function(){g.box.classList.remove("open"),g.pseudoCircle.classList.remove("open"),g.menu1.classList.remove("show"),g.toolbar.classList.remove("open")},availableCharts=function(t){var e=t;return{show:function(){[].concat(_toConsumableArray(document.querySelectorAll(".card2"))).filter(function(t){var a=t.getAttribute("id");return e.some(function(t){return a===t})}).map(function(t){return t.style.display="block"})}}},showAvailableCharts=function(t){var e=t;return{go:function(){switch([].concat(_toConsumableArray(document.querySelectorAll(".card2"))).map(function(t){return t.style.display="none"}),e){case"sale":availableCharts(["bar","line","area","pie"]).show();break;case"expenditure":availableCharts(["bar","line","area","geo"]).show();break;case"nrOfVisitors":availableCharts(["bar","line","pie","geo"]).show();break;case"socialMedia":availableCharts(["bar","area","pie","geo"]).show();break;case"compiledInfo":availableCharts(["line","area","pie","geo"]).show();break;case"nationalities":case"todaysEvent":availableCharts(["bar","line","area","geo"]).show();break;case"bookings":availableCharts(["bar","area","pie","line"]).show();break;case"mood":availableCharts(["bar","line","pie","geo"]).show()}}}};function addFirstCharts(){var t,e=slot(64).createArray();addSlotsToDOM(e).go();(t=g.allSlots).push.apply(t,_toConsumableArray(e));var a=[chartDiv("area").createDiv(),chartDiv("geo").createDiv(),chartDiv("pie").createDiv()];fetch("api/?/reports").then(function(t){return t.json()}).then(function(t){var e=[chart(t.reports.sale,"regular","AreaChart",a[0]).getChart(),chart(t.reports.nationalities,"regular","GeoChart",a[1]).getChart(),chart(t.reports.bookings,"pie","PieChart",a[2]).getChart()],o=0;g.allSlots.forEach(function(t,r){if("occupied"!==g.slotObjects[r].status&&a[++o-1]&&e[o-1]){var s=chartSize(a[o-1]).getSize(),i=s.elWidth,n=s.elHeight;placeCharts({div:a[o-1],chart:e[o-1],indx:r,increment:o,width:i,height:n}).go()}})})}function chartMouseDown(t){g.selected||(g.wrap.addEventListener("mousemove",chartMouseMove),g.selected=t.currentTarget,g.originalClickCoords={x:t.pageX,y:t.pageY},g.originalIndex=getIndexOfChartId(g.selected.getAttribute("data-id")).go(),g.selected.classList.add("dd-selected"),g.selected.classList.remove("dd-transition"),g.slotObjects.map(function(t){return t.status="available"}),g.allSlots.map(function(t){return t.dataset.status="available"}))}function chartMouseMove(t){if(g.selected){var e=g.wrap.getBoundingClientRect(),a=e.left+document.documentElement.scrollLeft,o=e.top+document.documentElement.scrollTop,r=t.pageX,s=t.pageY,i=r-a,n=s-o,l=getChartIdByCoords({x:i,y:n}).go(),c=(getSlotIdByCoords({x:i,y:n}).go(),g.selected),d=c.getAttribute("data-id"),u=g.originalIndex,h=getIndexOfChartId(d).go(),p=g.chartPositions[u].x,v=g.chartPositions[u].y;c.childNodes[0].classList.add("shadow-elevated");var b=p+(r-g.originalClickCoords.x),f=v+(s-g.originalClickCoords.y);void 0!==l&&g.lastTouched!==l&&(g.lastTouched=l,g.dataId.splice(l,0,g.dataId.splice(h,1)[0]),arrangeItems().go()),c.style.transform="translate3d("+b+"px, "+f+"px, 0)"}}function chartMouseUp(){g.selected&&(g.selected.classList.remove("dd-selected"),g.selected.classList.add("dd-transition"),g.selected.childNodes[0].classList.remove("shadow-elevated"),g.selected=null,g.originalClickCoords=null,arrangeItemsMouseUp().go())}g.box.addEventListener("click",function(){g.removeBox.style.display="block",this.classList.add("open"),g.pseudoCircle.classList.add("open"),g.menu1.classList.add("show"),g.toolbar.classList.add("open"),g.toolbar.classList.remove("fade-out")}),g.removeBox.addEventListener("click",function(){this.style.display="none",removeMenu()}),[].concat(_toConsumableArray(document.querySelectorAll(".add-container-2"))).map(function(t){t.addEventListener("click",function(t){var e=this.id;g.container2.classList.remove("out-of-sight"),g.toolbar.classList.add("fade-out"),setTimeout(function(){g.container2.classList.add("shadow")},300),t.currentTarget.setAttribute("data-selected","selected"),showAvailableCharts(e).go()})}),[].concat(_toConsumableArray(document.querySelectorAll(".card2"))).forEach(function(t){t.addEventListener("click",function(){for(var t=g.slotObjects.length,e=0;e<g.slotsPerRow;e++){var a=slot().createDiv(e+t);g.allSlots.push(a),addSlotsToDOM(g.allSlots).go()}addChartToDOM(this).go(),g.container2.classList.add("out-of-sight"),removeMenu()})});var dynamicTabBar=new mdc.tabs.MDCTabBar(document.querySelector("#icon-text-tab-bar")),panels=document.querySelector(".panels");function updatePanel(t){var e=panels.querySelector(".panel.is-active");e&&e.classList.remove("is-active");var a=panels.querySelector(".panel:nth-child("+(t+1)+")");a&&a.classList.add("is-active")}dynamicTabBar.preventDefaultOnClick=!0,dynamicTabBar.listen("MDCTabBar:change",function(t){updatePanel(t.detail.activeTabIndex)});